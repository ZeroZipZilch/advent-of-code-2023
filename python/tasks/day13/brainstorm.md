To find the smudge, it should be as simple as find out if ONE row doesn't match with all the others.
If that is the case, there is most likely a smudge. Try finding the smudge by looping through the characters,
and then changing all the characters to their opposites and trying again.